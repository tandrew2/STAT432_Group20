---
title: "regression models"
output: html_document
---

```{r include = FALSE}
wine = read.csv("wine.csv")
wine = wine[, -c(1, 2)]
```

```{r include = FALSE}
# Test-Split the data
set.seed(42)
wine_idx = createDataPartition(wine$quality, p = 0.75, list = FALSE)
wine_idx = sample(wine_idx)
wine_trn = wine[wine_idx,]
wine_tst = wine[-wine_idx,]
wine_tst = wine_tst[sample(nrow(wine_tst)),]
```

### Linear Regression
```{r}
set.seed(1753)
sim_lm_mod = train(
  quality ~ .,
  data = wine_trn,
  trControl = trainControl(method = "cv", number = 10),
  method = "lm"
)
```

### Random Forest
```{r}
set.seed(1753)
sim_rf_mod = train(
  quality ~ .,
  data = wine_trn,
  trControl = trainControl(method = "cv", number = 10),
  method = "rf"
)
```

### KNN
```{r}
set.seed(1753)
sim_knn_mod_scale = train(
  quality ~ .,
  data = wine_trn,
  trControl = trainControl(method = "cv", number = 10),
  preProcess = "scale",
  method = "knn"
)
```

```{r}
set.seed(1753)
sim_knn_mod_unscale = train(
  quality ~ .,
  data = wine_trn,
  trControl = trainControl(method = "cv", number = 10),
  method = "knn"
)
```

### Tree
```{r, message = FALSE, warning = FALSE}
set.seed(1753)
sim_rpart_mod = train(
  quality ~ .,
  data = wine_trn,
  trControl = trainControl(method = "cv", number = 10),
  method = "rpart"
)
```

```{r}
set.seed(1753)
sim_gbm_mod = train(
  quality ~ .,
  data = wine_trn,
  trControl = trainControl(method = "cv", number = 10),
  method = "gbm",
  verbose = FALSE
)
```

### Elastic Net

```{r}
sim_glmnet_mod = train(
  quality ~ .,
  data = wine_trn,
  trControl = trainControl(method = "cv", number = 10),
  method = "glmnet"
)
```

```{r, echo = FALSE}
reg_mod = list(sim_lm_mod, sim_rf_mod, sim_knn_mod_scale, sim_knn_mod_unscale, sim_rpart_mod, sim_gbm_mod, sim_glmnet_mod)
trn_pred = lapply(reg_mod, predict, wine_trn)
tst_pred = lapply(reg_mod, predict, wine_tst)

trn_rmse = sapply(trn_pred, calc_rmse, actual = wine_trn$quality)
tst_rmse = sapply(tst_pred, calc_rmse, actual = wine_tst$quality)
```

```{r, echo = FALSE}
regression_results = data.frame(
  mod = c("Linear Regression", "Random Forest", "KNN w/ Scaling", "KNN w/o Scaling", "Tree", "Boosted Tree", "Elastic Net"),
  trn_rmse = trn_rmse,
  tst_rmse = tst_rmse
)
colnames(regression_results) = c("Model Type", "Train RMSE", "Test RMSE")
kable_styling(kable(regression_results, format = "html", digits = 5), full_width = FALSE)
```


